{"mappings":"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","sources":["src/index.js","src/main.js/trending.js","src/main.js/templates.js/trending-switcher.js","src/main.js/templates.js/gallery-settigs.js","src/main.js/get-movies-by-genre.js","src/main.js/filter.js","src/main.js/search.js","src/main.js/local-storage.js"],"sourcesContent":["import './main.js/preloader';\nimport './main.js/requests';\nimport './main.js/save-genres';\nimport './main.js/trending';\nimport './main.js/search';\nimport './main.js/modal';\nimport './main.js/get-movies-by-genre';\n/* import './main.js/login'; */\nimport './main.js/user-manager';\nimport './main.js/theme-switcher';\nimport './main.js/local-storage';\nimport './main.js/footer-modal';\nimport './main.js/back-to-top';\n/* import './main.js/library-manager'; */\nimport './main.js/templates.js/gallery-settigs';\n","import { getTrending } from './requests';\nimport { period, createSwitcherMarkup } from './templates.js/trending-switcher';\nimport { paginator } from './paginator';\nimport { makeGallery } from './make-gallery';\nimport { addGallerySettings } from './templates.js/gallery-settigs';\n\nshowTrending(1, period);\n\npaginator.callback = showTrending;\n\nasync function showTrending(page = 1, timeWindow = period) {\n  try {\n    const data = await getTrending(page, timeWindow);\n    makeGallery(data.results);\n    addGallerySettings();\n    paginator.currentPage = data.page;\n    paginator.totalPages = data.total_pages;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport { showTrending };\n","let period = localStorage.getItem('switcher-period') || 'week';\n\nfunction createSwitcherMarkup(callback, container) {\n  const markup = `<div class=\"switcher__container\">\n    <span class=\"switcher__text\">Trending of the</span>\n        <div class=\"switcher\">\n          <div class=\"switcher__item\">\n            <input\n              type=\"radio\"\n              id=\"day\"\n              value=\"day\"\n              name=\"switcher\"\n              class=\"switcher__item-radio\"\n            />\n            <label for=\"day\" class=\"switcher__item-label\">\n              Day\n            </label>\n          </div>\n          <div class=\"switcher__item\">\n            <input\n              type=\"radio\"\n              id=\"week\"\n              value=\"week\"\n              name=\"switcher\"\n              class=\"switcher__item-radio\"\n            />\n            <label for=\"week\" class=\"switcher__item-label\">\n              Week\n            </label>\n          </div>\n        </div>\n    </div>`;\n\n  container.insertAdjacentHTML('beforeend', markup);\n  const switcher = document.querySelector('.switcher');\n  const options = switcher.querySelectorAll('.switcher__item-radio');\n\n  switcher.addEventListener('click', addSwitcher);\n  [...options].find(option => option.value === period).checked = true;\n\n  function addSwitcher(e) {\n    const optionToSelect = [...options].find(option => !option.checked);\n    optionToSelect.checked = true;\n\n    period = optionToSelect.value;\n\n    localStorage.setItem('switcher-period', period);\n\n    callback(1, period);\n  }\n}\n\nexport { period, createSwitcherMarkup };\n","import { gallery } from './gallery-markup';\nimport { addFilter } from '../filter';\nimport { createSwitcherMarkup } from './trending-switcher';\nimport { showTrending } from '../trending';\n\nfunction addGallerySettings() {\n  const settingsMarkup = `\n      <div class=\"gallery__settings\">\n        <div class=\"gallery__settings-container\">\n          <button class=\"filter__button\" type=\"button\">Select genre</button>\n        </div>\n        <ul class=\"filter__list is-hidden\"></ul>\n      </div>`;\n  gallery.insertAdjacentHTML('afterbegin', settingsMarkup);\n  const container = document.querySelector('.gallery__settings-container');\n\n  createSwitcherMarkup(showTrending, container);\n  addFilter();\n}\n\nexport { addGallerySettings };\n","import { getMovieBYGenre } from './requests';\nimport { makeGallery } from './make-gallery';\nimport { gallery } from './templates.js/gallery-markup';\nimport { paginator } from './paginator';\nimport { addGallerySettings } from './templates.js/gallery-settigs';\n\nlet genreID;\n\ngallery.addEventListener('click', e => {\n  e.preventDefault();\n  if (!e.target.className.includes('genre-link')) return;\n  e.stopImmediatePropagation();\n  searchByGenre(e.target.dataset.id);\n  paginator.callback = searchByGenre;\n  searchByGenre(1);\n});\n\nasync function searchByGenre(id, page) {\n  try {\n    const data = await getMovieBYGenre(id, page);\n    makeGallery(data.results);\n    addGallerySettings();\n    paginator.currentPage = data.page;\n    paginator.totalPages = data.total_pages < 500 ? data.total_pages : 500;\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nexport { searchByGenre };\n","import { searchByGenre } from './get-movies-by-genre';\nlet filterCategories = document.querySelector('.filter__categories');\nlet options = document.querySelector('.filter__list');\nlet filterBtn;\nlet lastSearch;\n\nfunction addFilter() {\n  options = document.querySelector('.filter__list');\n  filterBtn = document.querySelector('.filter__button');\n  filterBtn.addEventListener('click', genreFilter);\n}\n\nfunction genreFilter(e) {\n  e.target.classList.toggle('active');\n\n  options.classList.remove('is-hidden');\n\n  const genresList = JSON.parse(localStorage.getItem('genres'));\n  const optionsMarkup = genresList\n    .map(\n      ({ id, name }) =>\n        `<li class=\"filter__item\"><button class=\"filter__option\" type=\"button\" data-id=\"${id}\">${name}</button></li>`\n    )\n    .join('');\n  options.innerHTML = optionsMarkup;\n  options.addEventListener('click', showFilteredMovies);\n}\n\nfunction showFilteredMovies(e) {\n  if (e.target.nodeName !== 'BUTTON') return;\n  lastSearch = e.target.dataset.id;\n  try {\n    switchOptions(e);\n    searchByGenre(lastSearch, 1);\n  } catch (error) {}\n}\n\nfunction switchOptions(e) {\n  const currentActive = document.querySelector('.filter__option.active');\n  currentActive && currentActive.classList.remove('active');\n  e.target.classList.add('active');\n}\n\nexport { addFilter };\n","import { getMoviesByKeyword } from './requests';\nimport { paginator } from './paginator';\nimport { LoadSpinner } from './loader';\nimport { makeGallery } from './make-gallery';\n\nconst loadSpinnerBtn = new LoadSpinner({ selector: '[data-action=\"loading\"]' });\nconst headerForm = document.querySelector('.search-form');\nconst searchResult = document.querySelector('.search-result');\nconst WARNING_CLEAR_DELAY = 3000;\nlet lastQuery = '';\nconst searchMore = n => {\n  getMovies(lastQuery, n);\n};\nconst getMovies = async (query, page) => {\n  loadSpinnerBtn.enable();\n  let searched = await getMoviesByKeyword({\n    keyword: query,\n    page,\n  });\n  if (searched?.results?.length) {\n    makeGallery(searched.results);\n    searchResult.textContent = '';\n    lastQuery = query;\n    paginator.callback = searchMore;\n    paginator.currentPage = searched.page;\n    paginator.totalPages = searched.total_pages;\n  } else {\n    searchResult.textContent =\n      'Search result not successful. Enter the correct movie name and try again.';\n    clearInfo();\n  }\n  loadSpinnerBtn.disable();\n};\n\n\nconst onSearch = event => {\n  event.preventDefault();\n\n  const value = event.target['search-film'].value.trim();\n  if (value) {\n    getMovies(value, 1);\n  } else {\n    searchResult.textContent =\n      'Movie name must not be empty. Please, enter movie name to search.';\n    clearInfo();\n  }\n};\n\nheaderForm.addEventListener('submit', onSearch);\n\nconst clearInfo = () => {\n  setTimeout(() => {\n    searchResult.textContent = '';\n  }, WARNING_CLEAR_DELAY);\n};\n","import { setMovie, removeMovie, init } from './firebase';\n/* init(); */\nfunction setLocalStorage(data) {\n  const btnAddList = document.querySelector('.js-btn-add-list');\n  const btnAddToWatched = document.querySelector('[data-addto=\"watched\"]');\n  const btnAddToQueue = document.querySelector('[data-addto=\"queue\"]');\n  const userName = localStorage.getItem('user');\n\n  if (!userName) {\n    btnAddToWatched.setAttribute('disabled', true);\n    btnAddToQueue.setAttribute('disabled', true);\n  }\n\n  checkLS();\n\n  data.genre_ids = data.genres.map(g => g.id);\n\n  btnAddList.addEventListener('click', onBtnClick);\n\n  function onBtnClick(event) {\n    if (!event.target.hasAttribute('data-addto')) return;\n\n    const lsKey = `${userName}_${event.target.dataset.addto}`;\n\n    if (!localStorage.getItem(lsKey)) {\n      localStorage.setItem(lsKey, JSON.stringify([data]));\n      console.log(lsKey);\n\n      checkLS();\n\n      return;\n    }\n\n    let lsValue = JSON.parse(localStorage.getItem(lsKey));\n    const indForDel = lsValue.findIndex(fiml => fiml.id === data.id);\n\n    if (!!~indForDel) {\n      lsValue.splice(indForDel, 1);\n      localStorage.setItem(lsKey, JSON.stringify(lsValue));\n    } else {\n      lsValue.push(data);\n      localStorage.setItem(lsKey, JSON.stringify(lsValue));\n    }\n\n    checkLS();\n  }\n\n  function checkLS() {\n    if (localStorage.getItem(`${userName}_watched`)) {\n      let lsWatchedValue = JSON.parse(\n        localStorage.getItem(`${userName}_watched`)\n      );\n      const indInLS = lsWatchedValue.findIndex(fiml => fiml.id === data.id);\n\n      if (!!~indInLS) {\n        btnAddToWatched.textContent = `Remove from wached`;\n      } else {\n        btnAddToWatched.textContent = `Add to wached`;\n      }\n    }\n\n    if (localStorage.getItem(`${userName}_queue`)) {\n      let lsQueueValue = JSON.parse(localStorage.getItem(`${userName}_queue`));\n      const indInLS = lsQueueValue.findIndex(fiml => fiml.id === data.id);\n\n      if (!!~indInLS) {\n        btnAddToQueue.textContent = `Remove from queue`;\n      } else {\n        btnAddToQueue.textContent = `Add to queue`;\n      }\n    }\n  }\n}\n\nexport { setLocalStorage };\n"],"names":["parcelRequire","$bpxeT","$8nrFW","$0752efe90e900891$export$da0c8716dc13cd97","localStorage","getItem","$0752efe90e900891$export$854668381982e3df","callback","container","insertAdjacentHTML","switcher","document","querySelector","options","querySelectorAll","addEventListener","e","optionToSelect","$parcel$interopDefault","find","option","checked","value","setItem","$9xIcH","$c87cd0c2a48add4a$export$6451fc48e4dbc3ed","id","page","$c87cd0c2a48add4a$var$_searchByGenre","apply","this","arguments","$2TvXO","mark","_callee","data","$hOsrK","getMovieBYGenre","_ctx","sent","$fiCwh","makeGallery","results","$519fe35d8252a263$export$bc55da00e2f37ca","$4wcYQ","paginator","currentPage","totalPages","total_pages","console","log","t0","gallery","preventDefault","target","className","includes","stopImmediatePropagation","dataset","$5a79d6a54134d65b$var$lastSearch","$5a79d6a54134d65b$var$options","$5a79d6a54134d65b$var$genreFilter","classList","toggle","remove","optionsMarkup","JSON","parse","map","param","name","concat","join","innerHTML","$5a79d6a54134d65b$var$showFilteredMovies","nodeName","currentActive","add","$5a79d6a54134d65b$var$switchOptions","error","$df01db9501f35ba8$export$a02e51d251069742","$df01db9501f35ba8$var$_showTrending","timeWindow","_args","length","getTrending","$e7e76bc70a64536c$var$loadSpinnerBtn","$kI89v","LoadSpinner","selector","$e7e76bc70a64536c$var$headerForm","$e7e76bc70a64536c$var$searchResult","$e7e76bc70a64536c$var$lastQuery","$e7e76bc70a64536c$var$searchMore","n","$e7e76bc70a64536c$var$getMovies","query","ref","searched","enable","getMoviesByKeyword","keyword","textContent","$e7e76bc70a64536c$var$clearInfo","disable","event","trim","setTimeout"],"version":3,"file":"index.8e9c8c7b.js.map"}